<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>G-computation Algorithms in tvmedg • tvmedg</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="G-computation Algorithms in tvmedg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tvmedg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/single_mediator.html">Time-varying Mediation Analysis with Binary Exposure and Single Mediator</a></li>
    <li><a class="dropdown-item" href="../articles/tvmedg_algorithms.html">G-computation Algorithms in tvmedg</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/causalepi/tvmedg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>G-computation Algorithms in tvmedg</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/causalepi/tvmedg/blob/main/vignettes/tvmedg_algorithms.Rmd" class="external-link"><code>vignettes/tvmedg_algorithms.Rmd</code></a></small>
      <div class="d-none name"><code>tvmedg_algorithms.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Notations</p>
<ul>
<li><p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
denote the exposure of interest, taking values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>a</mi><mo>*</mo></msup><annotation encoding="application/x-tex">a^\ast</annotation></semantics></math>.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
be the outcome,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
the mediator,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
the time-varying confounder, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>
the vector of pre-exposure (time-fixed) covariates.</p></li>
<li><p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>a</mi></msub><annotation encoding="application/x-tex">Y_a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mi>a</mi></msub><annotation encoding="application/x-tex">M_a</annotation></semantics></math>
denote the values of the outcome and mediator, respectively, that would
have been observed had the exposure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
been set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>;
similarly,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><msup><mi>a</mi><mo>*</mo></msup></msub><annotation encoding="application/x-tex">Y_{a^\ast}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><msup><mi>a</mi><mo>*</mo></msup></msub><annotation encoding="application/x-tex">M_{a^\ast}</annotation></semantics></math>
represent the potential values under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msup><mi>a</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">A = a^\ast</annotation></semantics></math>.</p></li>
</ul>
<p>The average total effect can be then decomposed into natural direct
and indirect effects as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>a</mi></msub><mo>−</mo><msub><mi>Y</mi><msup><mi>a</mi><mo>*</mo></msup></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>M</mi><mi>a</mi></msub></mrow></msub><mo>−</mo><msub><mi>Y</mi><mrow><msup><mi>a</mi><mo>*</mo></msup><msub><mi>M</mi><msup><mi>a</mi><mo>*</mo></msup></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><munder><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>M</mi><mi>a</mi></msub></mrow></msub><mo>−</mo><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>M</mi><msup><mi>a</mi><mo>*</mo></msup></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Natural indirect effect</mtext></munder><mo>+</mo><munder><munder><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>M</mi><msup><mi>a</mi><mo>*</mo></msup></msub></mrow></msub><mo>−</mo><msub><mi>Y</mi><mrow><msup><mi>a</mi><mo>*</mo></msup><msub><mi>M</mi><msup><mi>a</mi><mo>*</mo></msup></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Natural direct effect</mtext></munder></mrow><annotation encoding="application/x-tex">
E(Y_a - Y_{a^*}) = E(Y_{aM_{a}} - Y_{a^*M_{a^*}}) =  \underbrace{E(Y_{aM_{a}} - Y_{aM_{a^*}})}_{\text{Natural indirect effect}} + \underbrace{E(Y_{aM_{a^*}} - Y_{a^*M_{a^*}})}_{\text{Natural direct effect}}
</annotation></semantics></math></p>
<p>The potential outcomes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>M</mi><mi>a</mi></msub></mrow></msub><annotation encoding="application/x-tex">Y_{aM_a}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><msup><mi>a</mi><mo>*</mo></msup><msub><mi>M</mi><msup><mi>a</mi><mo>*</mo></msup></msub></mrow></msub><annotation encoding="application/x-tex">Y_{a^\ast M_{a^\ast}}</annotation></semantics></math>
represent the values of the outcome under exposure levels
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>a</mi><mo>*</mo></msup><annotation encoding="application/x-tex">a^\ast</annotation></semantics></math>,
respectively, with the mediator taking its natural value under each
exposure. In contrast,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>M</mi><msup><mi>a</mi><mo>*</mo></msup></msub></mrow></msub><annotation encoding="application/x-tex">Y_{aM_{a^\ast}}</annotation></semantics></math>
describes the outcome under exposure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>,
but with the mediator set to the value it would have taken under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>a</mi><mo>*</mo></msup><annotation encoding="application/x-tex">a^\ast</annotation></semantics></math>,
capturing a cross-world scenario relevant to mediation analysis.</p>
<p>In the context of mediator–outcome confounders being affected by the
exposure (i.e., <span class="math inline">$Y_{am} \not\!\perp\!\!\!\perp
M_{a^*}|V$</span> - violation of identification condition), the natural
direct and indirect effect above are not identified. The randomized
interventional analogues were introduced.</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mrow><mi>a</mi><mo stretchy="false" form="prefix">|</mo><mi>v</mi></mrow></msub><annotation encoding="application/x-tex">G_{a|v}</annotation></semantics></math>
denote the a random draw from the distribution of the mediator with
exposure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
is set at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
conditional on covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>.
In other words,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
reflects a stochastic draw from its conditional distribution rather than
a fixed potential value of the mediator. The randomized interventional
analogues of natural direct and indirect effects are defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>G</mi><mi>a</mi></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><msup><mi>a</mi><mo>*</mo></msup><msub><mi>G</mi><msup><mi>a</mi><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>G</mi><mi>a</mi></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>G</mi><msup><mi>a</mi><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>a</mi><msub><mi>G</mi><msup><mi>a</mi><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><msup><mi>a</mi><mo>*</mo></msup><msub><mi>G</mi><msup><mi>a</mi><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
E(Y_{aG_{a} \mid v}) - E(Y_{a^*G_{a^*} \mid v}) 
= E(Y_{aG_{a} \mid v}) - E(Y_{aG_{a^*} \mid v}) 
+  E(Y_{aG_{a^*} \mid v}) - E(Y_{a^*G_{a^*} \mid v}) 
</annotation></semantics></math></p>
<p>In the longitudinal setting, the overbars denote the history of
variables up to time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
The total effect of a longitudinal exposure regime
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>a</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{a}</annotation></semantics></math>
versus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><annotation encoding="application/x-tex">\bar{a}^*</annotation></semantics></math>
can be decomposed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>∣</mo><mi>v</mi></mrow></msub></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><mrow><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><mo>∣</mo><mi>v</mi></mrow></msub></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><munder><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>∣</mo><mi>v</mi></mrow></msub></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><mrow><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><mo>∣</mo><mi>v</mi></mrow></msub></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">interventional indirect effect</mtext></munder><mo>+</mo><munder><munder><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><mrow><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><mo>∣</mo><mi>v</mi></mrow></msub></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><mrow><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><mo>∣</mo><mi>v</mi></mrow></msub></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">interventional direct effect</mtext></munder><mi>.</mi></mrow><annotation encoding="application/x-tex">
E(Y_{\bar{a} \bar{G}_{\bar{a} \mid v}} \mid v) - E(Y_{\bar{a}^* \bar{G}_{\bar{a}^* \mid v}} \mid v)
=  
\underbrace{E(Y_{\bar{a} \bar{G}_{\bar{a} \mid v}} \mid v) - E(Y_{\bar{a} \bar{G}_{\bar{a}^* \mid v}} \mid v)}_{\text{interventional indirect effect}}
+ 
\underbrace{E(Y_{\bar{a} \bar{G}_{\bar{a}^* \mid v}} \mid v) - E(Y_{\bar{a}^* \bar{G}_{\bar{a}^* \mid v}} \mid v)}_{\text{interventional direct effect}}.
</annotation></semantics></math></p>
<p>As shown by <a href="https://academic.oup.com/jrsssb/article/79/3/917/7040673" class="external-link">VanderWeele
and Tchetgen Tchetgen (2017)</a>, the interventional analogues of
natural direct and indirect effects, under the causal DAG (below) where
the mediator precedes the time-varying confounder
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
preceding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>),
can be identified using the so-called <em>mediational
g-formula</em>.</p>
<div class="figure" style="text-align: center">
<img src="../reference/figures/amly.png" alt="DAG for the context that the mediator precedes the time-varying confounder" width="80%"><p class="caption">
DAG for the context that the mediator precedes the time-varying
confounder
</p>
</div>
<p>In particular, the identification of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(Y_{\bar{a} \bar{G}_{\bar{a}^*}\mid v} \mid v)</annotation></semantics></math>
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mo>∫</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover></msub><msub><mo>∫</mo><mrow><mover><mi>l</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mo>,</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>d</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><mover><mi>a</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>×</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mo>∫</mo><mrow><msup><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>†</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>†</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>†</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>†</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
E(Y_{\bar{a} \bar{G}_{\bar{a}^*}\mid v} \mid v) =
&amp;\int_{\bar{m}} \int_{\bar{l}(T-1)}
E(Y \mid \bar{a}, \bar{m}, \bar{l}, v)
\prod_{t=1}^{T-1} dP\left( \bar{l}(t) \mid \bar{a}(t), \bar{m}(t), \bar{l}(t-1), v \right) \\
&amp;\times
\left[
\int_{\bar{l}^\dagger(T-1)}
\prod_{t=1}^{T}
P\left( m(t) \mid \bar{a}^*(t), \bar{m}(t-1), \bar{l}^\dagger(t-1), v \right)
\, dP\left( \bar{l}^\dagger(t-1) \mid \bar{a}^*(t-1), \bar{m}(t-1), \bar{l}^\dagger(t-2), v \right)
\right]
\end{align*}</annotation></semantics></math></p>
<p>In the context where time-varying confounder precedes the mediator
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
preceding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>)</p>
<div class="figure" style="text-align: center">
<img src="../reference/figures/almy.png" alt="DAG for the context that the time-varying confounder precedes the mediator" width="80%"><p class="caption">
DAG for the context that the time-varying confounder precedes the
mediator
</p>
</div>
<p>The <em>mediational g-formula</em> identification for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(Y_{\bar{a} \bar{G}_{\bar{a}^*}\mid v} \mid v)</annotation></semantics></math>
becomes</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mo>∫</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover></msub><msub><mo>∫</mo><mrow><mover><mi>l</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mo>,</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>d</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><mover><mi>a</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>×</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mo>∫</mo><mrow><msup><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>†</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>†</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>†</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>†</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
E(Y_{\bar{a} \bar{G}_{\bar{a}^*}\mid v} \mid v) =
&amp;\int_{\bar{m}} \int_{\bar{l}(T-1)}
E(Y \mid \bar{a}, \bar{m}, \bar{l}, v)
\prod_{t=1}^{T-1} dP\left( \bar{l}(t) \mid \bar{a}(t), \bar{m}(t-1), \bar{l}(t-1), v \right) \\
&amp;\times d\left[
\int_{\bar{l}^\dagger(T-1)}
\prod_{t=1}^{T}
P\left( m(t) \mid \bar{a}^*(t), \bar{m}(t-1), \bar{l}^\dagger(t), v \right)
\, dP\left( \bar{l}^\dagger(t) \mid \bar{a}^*(t), \bar{m}(t-1), \bar{l}^\dagger(t-1), v \right)
\right].
\end{align*}</annotation></semantics></math></p>
<p>For ease of notation, let’s adopt the same shorthand notations as in
the VanderWeele and Tchetgen Tchetgen (2017) paper:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a, a)</annotation></semantics></math>
to represent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><mover><mi>a</mi><mo accent="true">‾</mo></mover></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(Y_{\bar{a} \bar{G}_{\bar{a}}\mid v} \mid v)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a, a^*)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mover><mi>a</mi><mo accent="true">‾</mo></mover><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(Y_{\bar{a} \bar{G}_{\bar{a}^*}\mid v} \mid v)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mo>*</mo></msup><mo>,</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a^*, a^*)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><msub><mover><mi>G</mi><mo accent="true">‾</mo></mover><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup></msub><mo>∣</mo><mi>v</mi></mrow></msub><mo>∣</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(Y_{\bar{a}^* \bar{G}_{\bar{a}^*}\mid v} \mid v)</annotation></semantics></math>,</p>
</div>
<div class="section level2">
<h2 id="g-computation-algorithms-in-tvmedg">G-computation Algorithms in tvmedg<a class="anchor" aria-label="anchor" href="#g-computation-algorithms-in-tvmedg"></a>
</h2>
<p>tvmedg implements g-computation to estimate interventional direct and
indirect effects in longitudinal settings, based on the <em>mediational
g-formula</em> mentioned above. The core algorithm involves 4 main
steps:</p>
<ul>
<li>
<p><strong>Step 1: Fitting parametric models</strong></p>
<p><code><a href="../reference/tvmedg.html">tvmedg()</a></code> fits the user-specified regression models for
each time-varying variable, conditional on relevant history and baseline
covariates:</p>
<ul>
<li>Time-varying confounders:
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>L</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><mover><mi>a</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(\bar{L}(t) \mid \bar{a}(t), \bar{m}(t), \bar{l}(t-1), v)</annotation></semantics></math>
if
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
preceding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>)<br>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>L</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><mover><mi>a</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(\bar{L}(t) \mid \bar{a}(t), \bar{m}(t-1), \bar{l}(t-1), v)</annotation></semantics></math>
if
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
preceding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>)</li>
</ul>
</li>
<li>Mediator:
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∣</mo><msup><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msup><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>†</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(M(t) \mid \bar{a}^*(t), \bar{m}(t-1), \bar{l}^\dagger(t-1), v)</annotation></semantics></math></li>
</ul>
</li>
<li>Outcome:
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mover><mi>a</mi><mo accent="true">‾</mo></mover><mo>,</mo><mover><mi>m</mi><mo accent="true">‾</mo></mover><mo>,</mo><mover><mi>l</mi><mo accent="true">‾</mo></mover><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(Y \mid \bar{a}, \bar{m}, \bar{l}, v)</annotation></semantics></math></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Step 2: Monte Carlo sampling</strong><br>
Resample the values of all variables at baseline, including time-fixed
covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
and time-varying confounders
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t = 0</annotation></semantics></math>.
This step approximates the baseline covariate distribution and improves
the stability and precision of predictions in Step 3.</p></li>
<li><p><strong>Step 3: Predict follow-up</strong><br>
Using the baseline samples generated in Step 2, Step 3 simulates
follow-up trajectories by sequentially predicting time-varying
confounders, mediators, and outcomes under specified exposure regimes.
This process is illustrated in the following figure (as an example for
estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a, a^*)</annotation></semantics></math>)
in the context of binary outcome.</p></li>
</ul>
<div class="figure" style="text-align: center">
<img src="../reference/figures/tvmedg_gcomp.png" alt="g-computation in tvmedg" width="60%"><p class="caption">
g-computation in tvmedg
</p>
</div>
<ul>
<li>
<p><strong>Step 4: Estimating interventional analogues of natural
direct and indirect effects</strong><br>
Estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a, a)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a, a^*)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mo>*</mo></msup><mo>,</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a^*, a^*)</annotation></semantics></math>
at the end of follow-up and derive:</p>
<ul>
<li><p>Interventional total effect (rTE):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mo>*</mo></msup><mo>,</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a, a) - Q(a^*, a^*)</annotation></semantics></math></p></li>
<li><p>Interventional direct effect (rDE):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mo>*</mo></msup><mo>,</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a, a^*) - Q(a^*, a^*)</annotation></semantics></math></p></li>
<li><p>Interventional indirect effect:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msup><mi>a</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(a, a) - Q(a, a^*)</annotation></semantics></math></p></li>
<li><p>Proportional explain: Indirect effect / Total effect</p></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>VanderWeele, T. (2015). Explanation in causal inference: methods for
mediation and interaction. Oxford University Press.</p>
<p>VanderWeele, T. J., &amp; Tchetgen Tchetgen, E. J. (2017). Mediation
analysis with time varying exposures and mediators. Journal of the Royal
Statistical Society Series B: Statistical Methodology, 79(3),
917-938.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Quynh Long Khuong, Nguyen Pham Nguyen The, Thinh Ong, Kelly D. Getz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
